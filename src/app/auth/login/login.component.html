<div class="min-h-screen w-full flex">
  <!-- Panel izquierdo, visible solo en pantallas medianas o mayores -->
  <div class="hidden md:flex w-1/2 bg-gray-100 flex-col items-center justify-center p-8 text-center">
    <div class="mb-8">
      <img src="https://assets.api.uizard.io/api/cdn/stream/b13e5916-d78f-4824-9765-8c39285fcdea.png" alt="BankTicket logo" />
    </div>
    <h1 class="text-2xl font-semibold mb-2">BankTicket makes ticket management easy.</h1>
    <p class="text-gray-600">Create, update, and track tickets effortlessly.</p>
  </div>

  <!-- Panel derecho -->
  <div class="w-full md:w-1/2 flex flex-col p-8">
    <div class="flex justify-end items-center mb-8">
      <h2 class="text-xl font-semibold">BankTic</h2>
    </div>

    <div class="flex-1 flex flex-col justify-center max-w-sm mx-auto w-full">
      <!-- Título dinámico según el estado -->
      <h3 class="text-2xl font-semibold mb-6">
        {{ showMfaSetup ? 'Configurar autenticación de dos factores' : 
           showMfaInput ? 'Verificación de dos factores' : 'Log in' }}
      </h3>
      
      <form [formGroup]="loginForm" class="space-y-6">
        <!-- Campos de login (visibles solo si no está en modo MFA) -->
        <ng-container *ngIf="!showMfaSetup && !showMfaInput">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Correo</mat-label>
            <input matInput 
                   formControlName="email"
                   placeholder="example@mail.com" 
                   type="email" 
                   required />
            <mat-error *ngIf="loginForm.get('email')?.errors?.['required']">
              El correo es requerido
            </mat-error>
            <mat-error *ngIf="loginForm.get('email')?.errors?.['email']">
              Ingrese un correo válido
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Contraseña</mat-label>
            <input matInput 
                   formControlName="password"
                   [type]="hidePassword ? 'password' : 'text'"
                   placeholder="••••••••••" 
                   required />
            <button mat-icon-button matSuffix 
                    (click)="hidePassword = !hidePassword" 
                    type="button">
              <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="loginForm.get('password')?.errors?.['required']">
              La contraseña es requerida
            </mat-error>
          </mat-form-field>
        </ng-container>

        <!-- Configuración inicial de MFA -->
        <div *ngIf="showMfaSetup" class="space-y-6">
          <p class="text-gray-600">Escanee el código QR con su aplicación de autenticación:</p>
          <div class="flex justify-center">
            <qrcode [qrdata]="qrCodeUrl" [width]="256" [errorCorrectionLevel]="'M'"></qrcode>
          </div>
          
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Código de verificación</mat-label>
            <input matInput formControlName="mfaToken" type="text" placeholder="000000">
          </mat-form-field>
        </div>

        <!-- Campo de verificación MFA -->
        <mat-form-field *ngIf="showMfaInput && !showMfaSetup" appearance="fill" class="w-full">
          <mat-label>Código de verificación</mat-label>
          <input matInput formControlName="mfaToken" type="text" placeholder="000000">
        </mat-form-field>

        <!-- Botón dinámico según el estado -->
        <button mat-flat-button 
                class="w-full bg-black hover:bg-opacity-90 text-white" 
                [disabled]="loginForm.invalid || isLoading"
                (click)="login()">
          Log In
        </button>

        <!-- Enlace de contraseña olvidada (visible solo en login inicial) -->
        <button *ngIf="!showMfaSetup && !showMfaInput"
                mat-button 
                color="accent" 
                class="w-full text-sm font-normal"
                type="button">
          Forgot your password?
        </button>
      </form>
    </div>
  </div>
</div>
